<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"/><meta name="theme-color" content="#222"/><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/><meta name="renderer" content="webkit"/><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/><link rel="alternate" href="/rss.xml" title="Sakura" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="Sakura" type="application/atom+xml"><link rel="alternate" type="application/json" title="Sakura" href="https://sakurame.eu.org/feed.json"/><link rel="preconnect" href="https://s4.zstatic.net"/><link rel="preconnect" href="https://at.alicdn.com"/><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"/><link rel="dns-prefetch" href="https://unpkg.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.11"><link rel="modulepreload" href="/js/chunk-5Y6VMMPJ.js"></link><link rel="modulepreload" href="/js/chunk-BYJYVCTD.js"></link><link rel="modulepreload" href="/js/chunk-PNO2NHAN.js"></link><link rel="modulepreload" href="/js/chunk-XJ6P2B3P.js"></link><link rel="modulepreload" href="/js/copy-tex-AOYBWFMG.js"></link><link rel="modulepreload" href="/js/index.esm-JAJ67G4Q.js"></link><link rel="modulepreload" href="/js/post-3OMOVAIW.js"></link><link rel="modulepreload" href="/js/quicklink-MJWYQOW3.js"></link><link rel="modulepreload" href="/js/siteInit.js"></link><link rel="modulepreload" href="/js/tcomments-MH65CAA6.js"></link><link rel="preload" href="https://ptpimg.me/5344ez.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://ptpimg.me/wf2fu2.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://ptpimg.me/qnu794.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://ptpimg.me/e1davo.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://ptpimg.me/996d4a.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://ptpimg.me/0j50c8.jpg" as="image" fetchpriority="high"><meta name="keywords" content="视频压制技术系列教程"/><meta name="description" content="一个专注于技术和思考分享的博客"/><link rel="canonical" href="https://sakurame.eu.org/2024/03/16/vcbstudio/%E7%AC%AC%E4%BA%94%E7%AB%A0VapourSynth%E5%9F%BA%E7%A1%80/"><title>第五章VapourSynth基础</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">第五章VapourSynth基础</h1><div class="meta"><span class="item" title="创建时间：2024-03-16 23:07:59"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2024-03-16T23:07:59+08:00">2024-03-16</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>16k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>14 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Sakura's Blog</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" style="background-image: url(&quot;https://ptpimg.me/5344ez.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://ptpimg.me/wf2fu2.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://ptpimg.me/qnu794.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://ptpimg.me/e1davo.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://ptpimg.me/996d4a.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://ptpimg.me/0j50c8.jpg&quot;);"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemListElement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/vcbstudio/" itemprop="item" rel="index" title="分类于视频压制技术"><span itemprop="name">视频压制技术<meta itemprop="position" content="0"/></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://sakurame.eu.org/2024/03/16/vcbstudio/%E7%AC%AC%E4%BA%94%E7%AB%A0VapourSynth%E5%9F%BA%E7%A1%80/"/><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"/><meta itemprop="name" content="Sakura"/><meta itemprop="description" content=", 一个专注于技术和思考分享的博客"/></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sakura"/></span><div class="body md" itemprop="articleBody"><h1 id="第五章-vapoursynth基础"><a class="anchor" href="#第五章-vapoursynth基础">#</a> 第五章 VapourSynth 基础</h1>
<p>BDRip  的核心是预处理（pre-processing），没有经过预处理的画质调教，压片就只是单纯的数据压缩罢了，永远不可能有画质提升。历史上，最流行的预处理软件是 AviSynth（简称 AVS），然而由于年代久远，其许多设计理念和功能都有较多缺陷，现在逐步被新一代的预处理软件  VapourSynth（简称 VS）替代。本章就来讲解 VS 的基本构成，介绍预览工具和脚本，并从中学习 VS 基本语法和功能。</p>
<h2 id="1-vs简介"><a class="anchor" href="#1-vs简介">#</a> 1. VS 简介</h2>
<p>VapourSynth，简称 VS，官网是 <a target="_blank" rel="noopener" href="https://www.vapoursynth.com">https://www.vapoursynth.com</a>。你可以在 <a target="_blank" rel="noopener" href="https://github.com/vapoursynth/vapoursynth/releases">Github</a> 上下载最新版本，包括安装版和便携版。</p>
<p>VCB-Studio 目前使用的 VS 则是娱乐部版，全称 VapourSynth-Classic，简称 VS-C。你可以在<a target="_blank" rel="noopener" href="https://github.com/AmusementClub/vapoursynth-classic/releases">这里</a>下载最新版。</p>
<p>VS-C 源于 VS 社区的一次重大分裂。VS 项目开发者在 R55 引入了全新的 API4，这导致了严重的兼容性问题：API4 的 VS  虽然能够同时支持新的 API4 滤镜和旧的 API3 滤镜，但却不支持 API3 脚本。而这些多年传承的脚本才是 VS  发展的精髓，这对于追求稳定生产环境的 VCB-S 来说是不可接受的。</p>
<p>另一方面，VS 开发者在 API4 还引入了大量破坏性弃用，以迫使用户和滤镜开发者转向 API4。同时还采取先进的 user driven testing，让普通用户积极参与到新版的验证与反馈工作中。</p>
<p>基于以上复杂情况，总监 Akarin 创立了 VS-C，同时兼容 API3 与 API4 脚本，全力保证生产环境的向后兼容性。此外 VS-C 兼具前后两代 VS 之长，既有 API4 的低内存开销，又有 API3 的高处理速度。</p>
<p>有了 VS 本体，问题还没有完全解决。上述这些 VS 本体只含有少量的内置滤镜，这显然是远远不够的。收集滤镜和常用工具脚本是一件复杂繁琐的事，这里我们提供了一套打包好的便携版 VS-C，含有大部分常用滤镜和脚本：<a target="_blank" rel="noopener" href="https://github.com/AmusementClub/tools/releases%E3%80%82">https://github.com/AmusementClub/tools/releases。</a></p>
<p>打开 VS 目录，我们可以看到 VS 本体的一堆 dll 和 python 环境。VS 本体和滤镜都是由 C++ 编写，而它暴露给用户的接口则是  python 的。我们可以通过 python 编写 VS 脚本，然后通过 VSPipe 运行脚本获得输出。你可以认为 VS 是 python  的一个库，也可以认为 VS 使用 python 做 dsl (domain specific language) 或者更通俗地讲就是  glue（把滤镜给串联起来）。</p>
<p><code>vapoursynth64</code>  目录下是 VS 滤镜， <code>coreplugins</code>  是内置滤镜， <code>plugins</code>  是第三方滤镜。对于我们提供的 VS-C 包，AI 滤镜相关的模型和运行环境等也放在  <code>plugins</code>  目录。</p>
<p>同时，我们提供的包里的 python 还内置了 pip，可以方便地安装额外包。</p>
<p>将这一整套内容打包为便携包不是一件容易的事，事实上在上古时期，VS 基本都是通过安装来使用，这带来了严重的版本管理问题。</p>
<p>目前我们使用总监 SaltyChiang 开发的打包工具 <a target="_blank" rel="noopener" href="https://github.com/AmusementClub/VapourSynth-Portable-Maker">VapourSynth-Portable-Maker</a> 来完成打包工作，对打包有兴趣的同学可以看看。</p>
<h2 id="2-vs预览"><a class="anchor" href="#2-vs预览">#</a> 2. VS 预览</h2>
<p>有了 VSPipe，其实我们就已经可以运行脚本输出处理结果，但我们更希望可以实时修改脚本并看到滤镜的效果，这就需要一个预览器。</p>
<h3 id="1-vapoursynth-editor"><a class="anchor" href="#1-vapoursynth-editor">#</a> (1). VapourSynth-Editor</h3>
<p>预览器在很长时间里只有一个， <code>VapourSynth-Editor</code> （简称 vsedit 或 vse），<a target="_blank" rel="noopener" href="https://github.com/AmusementClub/VapourSynth-Editor%E3%80%82vse">https://github.com/AmusementClub/VapourSynth-Editor。vse</a> 是一个 IDE，可以在里面编写 VS 脚本，并进行预览、测试、调试等。它提供了少量的高光和代码补完功能，但不是很完善，只对滤镜起作用，对脚本函数则没有作用。vse 也没有提供代码的查找与替换功能，使用起来不太方便。</p>
<p>vse 需要依赖 VS 运行，而且原版 vse 优先选择注册表中的 VS 而不是用户指定的 VS，当系统中有多个 VS，或者曾经使用过安装版  VS，那你几乎永远无法知道它使用的是哪个 VS。当然目前娱乐部版已经修复了这个问题，它会优先找同目录的 VS，即开即用。</p>
<p>一般来说，VS 脚本文件都是 python 脚本，为了区分，我们用  <code>vpy</code>  作为后缀名。</p>
<p>这里有一个简单预览脚本：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> vapoursynth <span class="token keyword">as</span> vs</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> vapoursynth <span class="token keyword">import</span> core</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> havsfunc <span class="token keyword">as</span> haf</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> mvsfunc <span class="token keyword">as</span> mvf</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>a <span class="token operator">=</span> <span class="token string">"00010.m2ts"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>src8 <span class="token operator">=</span> core<span class="token punctuation">.</span>lsmas<span class="token punctuation">.</span>LWLibavSource<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>src8<span class="token punctuation">.</span>set_output<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>先看前四句，熟悉 python 的应该知道，这是在载入库。<br />
第一句载入 vapoursynth 本体，并简称为  <code>vs</code> 。<br />
第二句载入  <code>vs</code>  的  <code>core</code> 。 <code>core</code>  的概念比较抽象，不妨认为就是一种固定格式。<br />
这里可以换为等价的写法：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>core <span class="token operator">=</span> vs<span class="token punctuation">.</span>core</pre></td></tr></table></figure><p>一些早期的脚本可能会写成：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>core <span class="token operator">=</span> vs<span class="token punctuation">.</span>get_core<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这在 VS-C 中仍然能运行，但  <code>get_core</code>  即将弃用，不要这么写。<br />
第三四句，载入  <code>mvsfunc</code> （mawen1250 写的工具合集）和  <code>havsfunc</code> （Holy 从 AVS 移植的工具合集），并分别指定别名为  <code>mvf</code>  和  <code>haf</code> ，这是日常做番最常用到的工具。</p>
<p>再看后三句，这里细节很多，我们一个一个分析。</p>
<p>首先  <code>a = &quot;00010.m2ts&quot;</code> ，这是指定视频源文件的路径。<br />
一般写脚本的时候要避免这种单个字母的无脑命名。 但本组约定俗成采用 a 代指输入文件，注意在这之后的 OKE 中会用到。</p>
<p>这里使用的是相对路径，需要保证 00010.m2ts 和 vpy 脚本在同一目录下。 如果要使用绝对路径，可以这样： <code>a = R&quot;E:\Anime\00010.m2ts&quot;</code> 。 这里被 R 引号圈起来的是一个 Raw String，所见即所得，可以避免复杂的转义问题。 不然你就得写： <code>&quot;E:\\Anime\\00010.m2ts&quot;</code> 。</p>
<p>第二句  <code>src8 = core.lsmas.LWLibavSource(a)</code> ，这是使用源滤镜  <code>lsmas</code>  载入视频，获取一个在 vs 里称为 clip 的变量，并命名为  <code>src8</code> 。<br />
除了文件名之外的变量，一般需要有一定意义，方便解读。 通常我们用  <code>src</code>  指代源，8 表示精度，原盘一般都是 8-bit。 而最后的输出结果，则用  <code>res</code>  指代。</p>
<p>从这一行我们也能看出 vs 滤镜的使用规律，是  <code>core.&lt;package_name&gt;.&lt;filter_name&gt;(...)</code>  的形式。<br />
这里 lsmas 就是 package_name，而 LWLibavSource 就是 filter_name。<br />
脚本函数（比如上面提到的 mvf 和 haf）的使用则有些不同，是  <code>&lt;package_name&gt;.&lt;function_name&gt;(...)</code>  的形式，这一点我们会在后面看到。</p>
<p>最后，使用  <code>set_output()</code>  将读入的视频输出。</p>
<p>现在我们尝试使用 vsedit 来运行脚本。</p>
<p>如果你的滤镜载入正确，vsedit 应该可以高亮显示滤镜名称。 在上方工具栏选择  <code>Script - Check script</code> ，或者按  <code>F6</code> ，就可以检查脚本是否能正常输出。 如果是第一次读取某个视频文件，LWLibavSource 会生成一个后缀为  <code>lwi</code>  的索引文件，便于以后再次读取视频。 源文件越大，需要的时间越多，对于好几个 GB 的蓝光原盘需要等待几分钟。SSD 硬盘的话会快很多。</p>
<p>没有脚本没有问题，可以在 vsedit 下方看到如下信息。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image01.png" alt="img" /></p>
<p>否则会告诉你存在什么问题。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image02.png" alt="img" /></p>
<p>输出的信息，包括：总帧数、时长、分辨率、帧率、像素格式。</p>
<p>注意 VS 里帧数是 0-indexed 的，比如这个视频的帧数就是 0-16711，一共 16712 帧。<br />
帧率 24000/1001=23.976，这个数字要牢记，这是日本动画的典型帧率。<br />
最后像素格式 YUV420P8，说明这是 YUV 色彩空间，420 下采样，数据位深为 8-bit。</p>
<p>检查完了这些，就可以用  <code>Script - Preview</code> ，或者按  <code>F5</code>  来预览实际画面。</p>
<p>它会打开一个预览窗口，其中包含许多方便的功能。<br />
上方窗口可以拖动浏览整个画面，键盘上的前后键可以调整到上一帧或者下一帧。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image03.png" alt="img" /></p>
<p>左下角，可以点击进度条跳转到目标帧，也可以输入帧号定位。按三角形可以播放，旁边可以调整播放帧率。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image04.png" alt="img" /></p>
<p>右下角，点击画笔可以开启取色功能。鼠标移到画面上可以在左下角显示像素的 YUV 值以及渲染后的 RGB 值。</p>
<p>右下角还有放大镜 zoom 的选项，切换到  <code>fixed radio</code>  可以按倍数放大缩小，方便观察。可以选择缩放算法， <code>Nearest</code>  或者  <code>Bilinear</code> 。<br />
Nearest 是完全没有运算，只是单纯复制粘贴的缩放方法，将原来的 1 个像素变成 4 个，9 个，16 个...<br />
 注意不要用 Nearest 进行缩小或者非整数倍的放大，锯齿非常恐怖。<br />
Bilinear 是使用插值进行缩放，它是最简单的线性插值，所以一般也不会引入额外的副作用。我们通常都用 Nearest 放大进行观察，除了观察锯齿的时候，可能会用 Bilinear。</p>
<p>前面取色的时候我们看到，输出的 YUV 实际被渲染为 RGB 呈现，这是 vsedit 自动帮我们做了。但是 vsedit 做的精度不佳，所以我们通常在脚本里手动转为 RGB 进行预览。</p>
<p>我们把脚本改为：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>src8 <span class="token operator">=</span> core<span class="token punctuation">.</span>lsmas<span class="token punctuation">.</span>LWLibavSource<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>res <span class="token operator">=</span> mvf<span class="token punctuation">.</span>ToRGB<span class="token punctuation">(</span>src8<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>res<span class="token punctuation">.</span>set_output<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>再预览看看，有什么区别。 可以发现现在格式变为  <code>RGB24</code>  了。 注意这里调用 mvf，跟调用滤镜的区别，前面已经提到过了。</p>
<p>下面，找一个 10-bit 的视频（比如本组压制的成品），用同样的脚本再预览，看看有啥区别。 可以发现现在格式变为  <code>RGB30</code>  了。<br />
然后再改为  <code>src8.set_output()</code>  看看，可以发现格式变为  <code>YUV420P10</code> 。 所以 LWILibavSource 读取源的时候，是准确的读取了源的全部精度。</p>
<p>当然实际上 vsedit 渲染时，还是采用 RGB24，这可以利用取色器看到。 这是合理的，因为大部分人的显示器仍然还是 8-bit。</p>
<p>因此我们预览输出时，习惯是无论什么精度的源，都输出 8-bit RGB。 这可以通过  <code>res = mvf.ToRGB(src8, depth=8)</code>  或者  <code>res = mvf.Preview(src8)</code>  来实现。 这也是日常截图最标准的方法。</p>
<h3 id="2-vapoursynth-preview"><a class="anchor" href="#2-vapoursynth-preview">#</a> (2). VapourSynth-Preview</h3>
<p><code>VapourSynth-Preview</code> （简称 vspreview 或 vsp）是近两年兴起的另一个预览器，区别于 vsedit 的独立程序，vsp 是由 python 编写的模块，因此可以直接集成到 python 环境中。</p>
<p>vsp 的初始 repo 已经不再维护，因此目前版本繁多。我们使用的娱乐部版（也是 portable 包中集成的版本）：<a target="_blank" rel="noopener" href="https://github.com/AkarinVS/vapoursynth-preview%E3%80%82%E5%8F%A6%E4%B8%80%E4%B8%AA%E6%B4%BB%E8%B7%83%E7%9A%84%E7%89%88%E6%9C%AC%E6%98%AF">https://github.com/AkarinVS/vapoursynth-preview。另一个活跃的版本是</a> iew 版：<a target="_blank" rel="noopener" href="https://github.com/Irrational-Encoding-Wizardry/vs-preview%E3%80%82">https://github.com/Irrational-Encoding-Wizardry/vs-preview。</a></p>
<p>注意 iew 版与 VapourSynth-Classic 并不完全兼容，如果你有兴趣尝试一些新功能，可以使用这个兼容 VS-C 的版本：<a target="_blank" rel="noopener" href="https://github.com/SaltyChiang/vs-preview/tree/no-vstools%E3%80%82">https://github.com/SaltyChiang/vs-preview/tree/no-vstools。</a></p>
<p>vspreview 可以直接通过 pip 安装，参考上述 repo 的说明。目前 portable 包中已经预先安装好，可以通过下述命令使用（注意把  <code>python</code>  换成完整路径）：</p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>python -m vspreview xxx.vpy</pre></td></tr></table></figure><p>成功的话会弹出类似 vsedit 的预览窗口。</p>
<p>与 vsedit 不同，vsp 本体只是一个预览器，而不是一个 IDE，因此只能预览脚本，而无法编写脚本。为了方便使用，通常需要配合其他文本编辑器或者 IDE，下面介绍一个基于  <code>VSCode</code>  的开发环境搭建方案。</p>
<h4 id="vscode"><a class="anchor" href="#vscode">#</a> VSCode</h4>
<ol>
<li>安装  <code>VSCode</code> ，并在扩展商店里安装  <code>Python</code>  和  <code>Pylance</code>  扩展。</li>
<li>将本章  <code>.vscode</code>  目录的文件复制到 VSCode 用户配置目录  <code>%APPDATA%\Code\User\</code> 。如果用户配置目录已经有同名文件，不要覆盖，将相应内容复制到原有文件中。</li>
<li>修改  <code>settings.json</code>  中的 python 路径，改为你的 VapourSynth 对应的 python 路径。</li>
</ol>
<h4 id="vapoursynth"><a class="anchor" href="#vapoursynth">#</a> VapourSynth</h4>
<ol>
<li>安装 VapourSynth-Preview。可参考上述 repo 的说明，如果使用我们的 portable 包则不必再安装。</li>
<li>安装 <a target="_blank" rel="noopener" href="https://github.com/SaltyChiang/VapourSynth-Plugins-Stub-Generator/tree/R57Classic">VapourSynth-Plugins-Stub-Generator</a>。这是由总监 SaltyChiang 开发的小工具，用于在 VSCode 里支持代码补全。同样，portable 包中已经集成，不必再安装。 如果首次安装，运行  <code>python -m vsstubs install</code> ，如果使用 portable 包，运行  <code>python -m vsstubs update</code> 。注意以后每次增加滤镜都需要重新 update。</li>
</ol>
<p>以上，我们就配置好了全部所需内容。现在使用 VSCode 打开 vpy 脚本（或者所在文件夹），如果配置成功，可以看到脚本高亮和语法补全信息。接下来可以使用  <code>Ctrl+F6/Ctrl+F5</code>  进行类似 vsedit 的 F6/F5 的脚本检查 / 预览。不过这里的脚本检查只检查是否正常运行，不提供 vsedit 那样的 clip 信息。</p>
<p>我们的配置还提供了额外两个功能： <code>Ctrl+F7</code> ，相当于 vs info，打印输出 clip 的信息； <code>Ctrl+F8</code> ，相当于 vs benchmark，计算输出 clip 的所有帧，可以测试脚本速度。</p>
<p>vsp 的基本功能与 vsedit 差别不大，但更加易于使用。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image05.png" alt="img" /></p>
<p>左下角，最底下一栏显示 clip 信息，与 vsedit 类似，这里多了一个帧类型信息，可以看到这一帧为 P 帧。<br />
上面一栏，从左开始， <code>output</code>  按钮选择输出节点，后面  <code>sync outputs</code>  选择是否在节点间同步，这个功能我们后面再说。<br />
第二个按钮指定帧号，第三个指定时间戳，后面 100% 的按钮选择缩放倍率，vsp 里默认是 Nearest 算法。最后  <code>Timeline</code>  可以切换时间轴按时间戳显示还是按帧号显示。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image06.png" alt="img" /></p>
<p>右下角 5 个功能，每个功能都可以独立开启或关闭，我们一个一个说。</p>
<ol>
<li>Playback</li>
</ol>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image07.png" alt="img" /></p>
<p>就是各种播放选项，中间按钮播放 / 暂停，可以在最后边控制播放速度，选择  <code>Unlimited FPS</code>  可以最高速度播放，实际速度取决于输出 clip 所用滤镜和最后渲染的速度。</p>
<p>播放键左右依次，一个箭头的是以 1 帧为单位后退 / 前进，两个箭头的是以右边指定的帧数为单位后退 / 前进，三个箭头直接转到第一帧 / 最后一帧。</p>
<ol>
<li>Scening</li>
</ol>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image08.png" alt="img" /></p>
<p>在时间轴上做标记，在分段或者采样典型场景的时候会很有用。</p>
<p><code>List</code>  表示一组标记，时间轴只能同时显示一组标记，但可以在多组之间切换。 <code>Add List</code>  创建一组标记，然后可以在下方一栏添加标记。<br />
 <code>AB</code>  直接标记当前帧，并添加到 List。 <code>A</code>  将当前帧标记为起点， <code>B</code>  将当前帧标记为终点，A、B 联合使用可以标记一段区间，然后点  <code>Add to List</code>  加入到 List 中。</p>
<p>最右边的按钮可以导出当前 List 的所有标记，可以手动调整导出格式，导出后存放在剪切板里，找个地方粘贴即可。</p>
<ol>
<li>Pipette</li>
</ol>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image09.png" alt="img" /></p>
<p>这个功能相当于 vsedit 的取色器，鼠标移到画面上可以在左下角显示像素的 YUV 值以及渲染后的 RGB 值。</p>
<p>从左到右依次为：坐标  <code>(x, y)</code> ，渲染后 RGB 值，输出 clip 原始像素值。<br />
视频里的坐标轴以左上角为原点，横向向右为 x 轴正向，竖向向下为 y 轴正向。<br />
原始和渲染后的像素都有 3 组表示，第一组是 16 进制的量化值，第二组是 10 进制的量化值，第三组是浮点值。</p>
<p>vsp 采用 vs 滤镜来渲染输出 clip，不像 vse 那样有较大精度问题，因此一般可以直接 set_output 输出，不用转为 RGB。</p>
<ol>
<li>Benchmark</li>
</ol>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image10.png" alt="img" /></p>
<p>就是跑测试输出，与之前说的 Ctrl+F8 快捷键相比，可以更精确地指定输出的帧数范围。</p>
<ol>
<li>Misc</li>
</ol>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image11.png" alt="img" /></p>
<p><code>Reload Script</code>  如果你更改了脚本，可以按这个重新加载。<br />
 <code>Save</code>  导出 vsp 设置，比如前面提到的部分选项，它可以记忆下来，下次打开直接启用。当然一般不需要这个功能，因为 vsp 会自动保存到脚本所在目录的  <code>.vspreview</code>  目录下。<br />
 <code>Copy Frame</code>  /  <code>Save Frame as</code>  可以复制 / 保存当前帧截图，右边可以设置导出文件名。</p>
<p>好了，经典版 vsp 的功能就讲这么多，其中一些功能有快捷键：<a target="_blank" rel="noopener" href="https://github.com/Endilll/vapoursynth-preview/wiki/Keyboard-Shortcuts%E3%80%82">https://github.com/Endilll/vapoursynth-preview/wiki/Keyboard-Shortcuts。</a></p>
<p>另外，前面提到的一些改版，有兴趣的话可以自行研究它们的新功能。</p>
<h3 id="3-对比脚本"><a class="anchor" href="#3-对比脚本">#</a> (3). 对比脚本</h3>
<p>对比脚本，顾名思义就是用来对比源和压制成品的脚本。</p>
<p>下面是一个简单的对比脚本：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> vapoursynth <span class="token keyword">as</span> vs</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> vapoursynth <span class="token keyword">import</span> core</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> havsfunc <span class="token keyword">as</span> haf</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> mvsfunc <span class="token keyword">as</span> mvf</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>a <span class="token operator">=</span> <span class="token string">R"D:\VCB-Studio Entry Test 2023\Q4 [E46686C4].m2ts"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>src8 <span class="token operator">=</span> core<span class="token punctuation">.</span>lsmas<span class="token punctuation">.</span>LWLibavSource<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>src8 <span class="token operator">=</span> mvf<span class="token punctuation">.</span>Preview<span class="token punctuation">(</span>src8<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>src8<span class="token punctuation">.</span>set_output<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>b <span class="token operator">=</span> <span class="token string">R"D:\VCB-Studio Entry Test 2023\Q4_AV1 [41A7EDDA].mkv"</span></pre></td></tr><tr><td data-num="12"></td><td><pre>rip <span class="token operator">=</span> core<span class="token punctuation">.</span>lsmas<span class="token punctuation">.</span>LWLibavSource<span class="token punctuation">(</span>b<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>rip <span class="token operator">=</span> mvf<span class="token punctuation">.</span>Preview<span class="token punctuation">(</span>rip<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>rip<span class="token punctuation">.</span>set_output<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>现在用 vse 预览试试，在键盘上按数字 0、1 来切换两个输出。<br />
如果你试图切换到不存在的节点就会。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image12.png" alt="img" /></p>
<p>这里在 set_output 时使用了不同的输出节点。在以前，只有 0 节点（也是不指定输出节点时的默认值）能被预览输出，而 vspipe 始终只能输出 0 节点的 clip。预览器 vsp 首先支持了多节点预览输出，之后 vsedit 也添加了相应功能。</p>
<p>vsedit 的输出节点与键盘数字是绑定的，也就是最多只能有 0-9 号共 10 个节点可以使用，并且 vsedit 要求必须至少有 0 节点。<br />
当然，你可以输出到更高数字的节点，脚本仍然可以运行，但无法在 vsedit 中预览到。</p>
<p>作为多节点输出的开创者，vsp 对这一功能的支持更加完善。<br />
vsp 的输出节点不与键盘数字绑定，而是按照脚本中 set_output 出现的先后顺序，依次对应到键盘数字：1、2、3... 同时也不要求一定有 0 节点输出。</p>
<p>不使用键盘数字 0 作为第一个快捷键可以优化没有小键盘时的体验，输出节点数字不绑定快捷键可以避免不停修改节点值。当然 vsp 也不支持过多的节点数，超过 10 个节点只能在左下角的下拉框中切换。不过你可以自行修改 vsp 的配置，因为它是一个 python  module，你可以自由修改其功能，比如绑定节点数字，比如扩展更多键位。</p>
<p>之前略过的一个按钮， <code>sync outputs</code> ，可以选择让所有输出节点指向同一帧，或者各自维护一个当前帧号。</p>
<p>在上古时期，没有多节点输出的时候，是用  <code>Interleave</code>  滤镜来进行对比预览的。试着在上述脚本最后加上下面两行，观察结果。</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>res <span class="token operator">=</span> core<span class="token punctuation">.</span>std<span class="token punctuation">.</span>Interleave<span class="token punctuation">(</span><span class="token punctuation">[</span>src8<span class="token punctuation">,</span> rip<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res<span class="token punctuation">.</span>set_output<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>可以发现，视频总时长不变，输出帧数翻倍，帧率也翻倍，变成了 47.952 fps。<br />
实际上滤镜是在一秒内把源和成品的帧都给塞进去了，偶数帧（0, 2, 4...）来自源，奇数帧（1, 3, 5...）来自成品。这样可以通过前后键，反复观察源和成品的画面区别。</p>
<p>Interleave 支持输入一个 clip 列表，把里面的 clip 依次交错输出。自然你也可以将多个 clip  一起交错对比，但是多于两个的时候有诸多不便，首先你无法直观从帧号判断这帧来自哪个 clip，其次越过一些帧对比，比如将 1 和 3  进行对比时无法快速切换。<br />
当然现在是好时代了，可以通过多节点输出自由地进行对比。</p>
<h2 id="3-vs文档阅读和参数传递"><a class="anchor" href="#3-vs文档阅读和参数传递">#</a> 3. VS 文档阅读和参数传递</h2>
<h3 id="1-文档阅读"><a class="anchor" href="#1-文档阅读">#</a> (1). 文档阅读</h3>
<p>今后我们将遇到各种各样的滤镜，虽然代码补全可以帮助我们知道它的参数，但具体每个参数的含义和用法，还是需要查阅相关文档。</p>
<p>VS-C 的文档链接如下：<a target="_blank" rel="noopener" href="https://amusementclub.github.io/doc/%E3%80%82">https://amusementclub.github.io/doc/。</a></p>
<p>其中包括 VS 相关的 python 数据结构文档，内置滤镜的文档以及 VSPipe 的用法等。</p>
<p>第三方滤镜，一般都有单独的 Github repo，你需要善于搜索。一般可以先去娱乐部看一下，大部分常用滤镜都有相应 fork。</p>
<p>先来看前面提到的  <code>Interleave</code>  滤镜，<a target="_blank" rel="noopener" href="https://amusementclub.github.io/doc/functions/video/interleave.html%E3%80%82">https://amusementclub.github.io/doc/functions/video/interleave.html。</a></p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image13.png" alt="img" /></p>
<p>滤镜的包名  <code>std</code> ，说明是标准内置滤镜。 再看滤镜参数，第一个必选参数是  <code>vnode[]</code> ，即多个 clip 组成的列表。后半部分由 [] 扩起来的，是可选参数，包括  <code>extend, mismatch, modify_duration</code> ，都是 bint，也就是 0/1，或者 False/True。它们的功能 doc 里都有说明，不需要掌握，平时根本用不到。</p>
<h3 id="2-参数传递"><a class="anchor" href="#2-参数传递">#</a> (2). 参数传递</h3>
<p>VS 中的参数传递有多种方式：关键字传参、位置传参、混合传参。</p>
<ol>
<li>关键字传参 keyword argument</li>
</ol>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>core<span class="token punctuation">.</span>std<span class="token punctuation">.</span>Interleave<span class="token punctuation">(</span>clips<span class="token operator">=</span><span class="token punctuation">[</span>src<span class="token punctuation">,</span> rip<span class="token punctuation">]</span><span class="token punctuation">,</span> extend<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> modify_duration<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>哪个输入对应哪个参数，直接用参数名写出来。这样可读性很高，也不容易出错。另外，现在有代码补全，也不需要手打参数名。</p>
<ol>
<li>位置传参 positional argument</li>
</ol>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>core<span class="token punctuation">.</span>std<span class="token punctuation">.</span>Interleave<span class="token punctuation">(</span><span class="token punctuation">[</span>src<span class="token punctuation">,</span> rip<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>从左到右将输入依次赋给各个参数。写起来最简单，但可读性很差，要翻 doc 才知道各个参数都给的什么值。</p>
<ol>
<li>混合传参</li>
</ol>
<p>顾名思义就是混合前两种方式。python（和几乎所有编程语言）都规定，函数参数的必选项在前面，可选项在后面。因此习惯前面常用的参数用位置传参，后面不常用的参数使用关键字传参。注意位置传参只能放在前面，不能和关键字交替使用。</p>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>core<span class="token punctuation">.</span>std<span class="token punctuation">.</span>Interleave<span class="token punctuation">(</span><span class="token punctuation">[</span>src<span class="token punctuation">,</span> rip<span class="token punctuation">]</span><span class="token punctuation">,</span> modify_duration<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这里需要注意的是，VS 滤镜和 python 函数（比如 mvf 提供的函数）的处理是不一样的。<br />
对于 VS 滤镜，它会先将所有关键字参数赋值好，然后将位置参数从左到右依次赋给<strong>还未赋值</strong>的参数。</p>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>core<span class="token punctuation">.</span>std<span class="token punctuation">.</span>Interleave<span class="token punctuation">(</span><span class="token punctuation">[</span>src<span class="token punctuation">,</span> rip<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> extend<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这个调用会先将 extend 赋为 0，然后 [src, rip] 赋给 clips，最后一个参数，按位置将赋给 extend，但发现以前已经赋值过了，因此会赋给第三个参数 mismatch。</p>
<p>但是 python 函数并不会这么处理，如果关键字传参和位置传参对同一参数赋值，会报出语法错误。</p>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>mvf<span class="token punctuation">.</span>ToRGB<span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> matrix<span class="token operator">=</span><span class="token string">"709"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这个调用会报出对同一位置赋值的错误。</p>
<ol>
<li>dict 传参</li>
</ol>
<p>这其实是关键字传参的一种变体，用一个 dict 描述关键字，然后用 dict 传入参数。</p>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>kwargs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"depth"</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">:</span> <span class="token string">"709"</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res <span class="token operator">=</span> mvf<span class="token punctuation">.</span>ToRGB<span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></pre></td></tr></table></figure><ol>
<li>iterable 传参</li>
</ol>
<p>这其实是位置传参的一种变体，用一个 iterable 对象描述待传参数。<br />
这种传参方式对位置要求严格，要传的参数必须按函数参数列表的位置依次给出。<br />
实际上这在 VS 里极少出现，也不推荐使用这种方式，一般只会在阅读复杂代码时遇到。</p>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"709"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span>INTEGER<span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res <span class="token operator">=</span> mvf<span class="token punctuation">.</span>ToRGB<span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span></pre></td></tr></table></figure><ol>
<li>滤镜串联</li>
</ol>
<p>VS 滤镜都是由 clip 作为第一个参数，在连续调用时可以串联，省去输入第一个参数。</p>
<p>比如：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>res <span class="token operator">=</span> core<span class="token punctuation">.</span>lsmas<span class="token punctuation">.</span>LWLibavSource<span class="token punctuation">(</span><span class="token string">"00001.m2ts"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rgvs<span class="token punctuation">.</span>RemoveGrain<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这等价于：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>src <span class="token operator">=</span> core<span class="token punctuation">.</span>lsmas<span class="token punctuation">.</span>LWLibavSource<span class="token punctuation">(</span><span class="token string">"00001.m2ts"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res <span class="token operator">=</span> core<span class="token punctuation">.</span>rgvs<span class="token punctuation">.</span>RemoveGrain<span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>串联滤镜可以连接任意多个，除了第一个要写 core，后面的滤镜都不用写，直接跟在前一个滤镜的后面写滤镜名就行。同时，后面串联的滤镜也不用写第一个 clip 参数。</p>
<p>但是对于 python 函数，mvf 那种，就没有这样的写法，只能老老实实分为多行调用。</p>
<p>或者像下面这样：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>res <span class="token operator">=</span> mvf<span class="token punctuation">.</span>Preview<span class="token punctuation">(</span>core<span class="token punctuation">.</span>lsmas<span class="token punctuation">.</span>LWLibavSource<span class="token punctuation">(</span><span class="token string">"00001.m2ts"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="4-视频属性和帧属性"><a class="anchor" href="#4-视频属性和帧属性">#</a> 4. 视频属性和帧属性</h2>
<h3 id="1-视频属性-clip-property"><a class="anchor" href="#1-视频属性-clip-property">#</a> (1). 视频属性 clip property</h3>
<p>clip 对象，在 VS 里是 VideoNode 类。 文档在：<a target="_blank" rel="noopener" href="https://amusementclub.github.io/doc/pythonreference.html#VideoNode%E3%80%82">https://amusementclub.github.io/doc/pythonreference.html#VideoNode。</a></p>
<p>这里常用的就是前几个属性，包括：视频格式  <code>format</code> ，宽度  <code>width</code> ，高度  <code>height</code> ，总帧数  <code>num_frames</code> ，帧率  <code>fps</code>  或者用两个整数表示的  <code>fps_num</code>  和  <code>fps_den</code> 。</p>
<p>可以使用</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>clip<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>运行时在终端里打印这些信息。当然，vsedit 是看不到的。</p>
<p>我们可以使用  <code>text.ClipInfo</code>  滤镜在画面上打印 clip 信息。</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>res <span class="token operator">=</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>ClipInfo<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res<span class="token punctuation">.</span>set_output<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image14.png" alt="img" /></p>
<h3 id="2-帧属性-frame-property"><a class="anchor" href="#2-帧属性-frame-property">#</a> (2). 帧属性 frame property</h3>
<p>除了 clip 对象，还有一个需要关注的，帧对象，在 VS 叫做 VideoFrame 类。 文档在：<a target="_blank" rel="noopener" href="https://amusementclub.github.io/doc/pythonreference.html#VideoFrame%E3%80%82">https://amusementclub.github.io/doc/pythonreference.html#VideoFrame。</a></p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image15.png" alt="img" /></p>
<p>这里我们主要关注的是  <code>props</code>  属性。<br />
可以通过  <code>text.FrameProps</code>  滤镜在画面上打印每帧的 props 信息。</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>res <span class="token operator">=</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>FrameProps<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res<span class="token punctuation">.</span>set_output<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image16.png" alt="img" /></p>
<p>其中重要的属性包括： <code>_PictType, _ChromaLocation, _ColorRange, _Matrix, _Primaries, _Transfer, _FieldBased</code> 。</p>
<p>根据文档给的链接，我们看到它们的具体定义。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image17.png" alt="img" /></p>
<p><code>_PictType</code> ，帧类型，包括  <code>I/B/P</code>  帧。</p>
<p><code>_ChromaLocation</code> ，色度平面的对齐方式，最常见的，也即是 MPEG-2 标准的左中对齐为  <code>left=0</code> 。</p>
<p><code>_ColorRange</code> ，数值范围，这里很反直觉的是， <code>full=0</code> ， <code>limited=1</code> 。事实上除了 frame props，其他地方都是  <code>full=1</code> ， <code>limited=0</code> 。另外文档也给出了具体的计算公式。</p>
<p><img loading="lazy" data-src="https://guides.vcb-s.com/media/basic-guide-05/image18.png" alt="img" /></p>
<p><code>_Matrix, _Primaries, _Transfer</code> ，需要记住  <code>&quot;709&quot;=1</code> ， <code>&quot;601&quot;=6</code> ，其他的用到时查文档。</p>
<p><code>_FieldBased</code> ，场类型，0 逐行，1 底场优先，2 顶场优先。这个属性会在之后的 30 fps 课程中用到。</p>
<p>在实际操作中，我们可以手动更改这些 frame props。</p>
<p>设置 / 删除 frame props 的用法如下：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>res <span class="token operator">=</span> core<span class="token punctuation">.</span>std<span class="token punctuation">.</span>SetFrameProps<span class="token punctuation">(</span>res<span class="token punctuation">,</span> _Matrix<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res <span class="token operator">=</span> core<span class="token punctuation">.</span>std<span class="token punctuation">.</span>RemoveFrameProps<span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"_Matrix"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>实际上我们可以设置任意名字的 frame props，但它们大部分时候并没有用处。而这些由 VS 保留的 frame props 则有重要功能，一些滤镜比如  <code>resize</code>  会读取它们来决定进行何种计算，如果 frame props 指定的不正确就可能产生预料之外的错误结果。</p>
<p>一般来说，对于 1080p 的视频不需要刻意关注  <code>_Matrix, _Primaries, _Transfer</code>  等等，它们在未指定或者不存在时，滤镜会自动 fallback 到 709 对应的值。但是在制作 DVD 或者 UHD 等特殊分辨率的视频时，就需要特别关注这些 frame props，确保它们符合相应规范。</p>
<h2 id="5-vspipe的使用"><a class="anchor" href="#5-vspipe的使用">#</a> 5. VSPipe 的使用</h2>
<p><code>VSPipe</code>  是运行脚本，输出视频的核心工具。 文档在：<a target="_blank" rel="noopener" href="https://amusementclub.github.io/doc/output.html%E3%80%82">https://amusementclub.github.io/doc/output.html。</a></p>
<ol>
<li>输出给 x265 进行压制</li>
</ol>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>vspipe.exe --y4m script.vpy - | x265.exe --y4m -D 10 --output "output.hevc" -</pre></td></tr></table></figure><p>注意必须在标准命令行  <code>cmd</code>  里使用上述 pipe 方式， <code>PowerShell</code>  容易出现一些奇怪问题。</p>
<ol>
<li>输出 y4m 文件</li>
</ol>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>vspipe.exe --y4m script.vpy output.y4m</pre></td></tr></table></figure><p>当然也可以输出 yuv 文件。</p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>vspipe.exe script.vpy output.yuv</pre></td></tr></table></figure><p>yuv 和 y4m 都是无压缩的视频数据，区别在于后者自带了分辨率、帧率、像素格式等有效信息，而前者就是单纯的数据。<br />
事实上我们可以计算 yuv 文件的大小。假设目前有一个 35000 帧，分辨率为 1920x1080，像素格式 YUV420P8 的 yuv 视频，那么它的视频体积为：</p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>35000 * (1920 * 1080 + 2 * (1920 / 2) * (1080 / 2)) * 8 bit = 108,864,000,000 B ~= 101.3875 GiB</pre></td></tr></table></figure><p>如果数据位深为 10-bit 或者 16-bit，那么每个像素分量占据 2 个字节，计算也是类似的。</p>
<ol>
<li>只计算各帧但不输出（用于测试脚本速度）</li>
</ol>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>vspipe.exe -p script.vpy .</pre></td></tr></table></figure><h2 id="6-练习"><a class="anchor" href="#6-练习">#</a> 6. 练习</h2>
<h3 id="1"><a class="anchor" href="#1">#</a> (1)</h3>
<p>熟悉  <code>vsedit</code> 、 <code>vspreview</code> 、 <code>vspipe</code>  的使用。</p>
<h3 id="2"><a class="anchor" href="#2">#</a> (2)</h3>
<p>阅读文档并学习以下滤镜的用法： <code>BlankClip, StackVertical, StackHorizontal, AssumeFPS, Minimum, Maximum, Reverse, Transpose, Turn180</code> 。</p>
<div class="tags"><a href="/tags/%E8%A7%86%E9%A2%91%E5%8E%8B%E5%88%B6%E6%8A%80%E6%9C%AF%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/" rel="tag"><i class="ic i-tag"></i>视频压制技术系列教程</a></div></div><footer><div class="meta"><span class="icon"><i class="ic i-eye"></i></span><span>此文章已被阅读次数:</span><span class="waline-pageview-count" id="twikoo_visitors" data-path="/2024/03/16/vcbstudio/第五章VapourSynth基础/">正在加载...</span><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2024-03-16 23:08:43" itemprop="dateModified" datetime="2024-03-16T23:08:43+08:00">2024-03-16</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/bitcoin.png" alt="Sakura 比特币"/><p>比特币</p></div><div><img loading="lazy" data-src="/assets/monero.png" alt="Sakura monero"/><p>monero</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>Sakura<i class="ic i-at"><em>@</em></i>Sakura</li><li class="link"><strong>本文链接：</strong><a href="https://sakurame.eu.org/2024/03/16/vcbstudio/%E7%AC%AC%E4%BA%94%E7%AB%A0VapourSynth%E5%9F%BA%E7%A1%80/" title="第五章VapourSynth基础">https://sakurame.eu.org/2024/03/16/vcbstudio/第五章VapourSynth基础/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E8%AE%A4%E8%AF%86%E7%91%95%E7%96%B5/" rel="prev" itemprop="url" data-background-image="https:&#x2F;&#x2F;ptpimg.me&#x2F;58864f.jpg" title="第四章认识瑕疵"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>视频压制技术</span><h3>第四章认识瑕疵</h3></a></div><div class="item right"><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%85%AD%E7%AB%A0VS%E5%9F%BA%E7%A1%80%E6%BB%A4%E9%95%9C/" rel="next" itemprop="url" data-background-image="https:&#x2F;&#x2F;ptpimg.me&#x2F;26w1d1.jpg" title="第六章VS基础滤镜"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>视频压制技术</span><h3>第六章VS基础滤镜</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-vapoursynth%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text"> 第五章 VapourSynth 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-vs%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text"> 1. VS 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-vs%E9%A2%84%E8%A7%88"><span class="toc-number">1.2.</span> <span class="toc-text"> 2. VS 预览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-vapoursynth-editor"><span class="toc-number">1.2.1.</span> <span class="toc-text"> (1). VapourSynth-Editor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-vapoursynth-preview"><span class="toc-number">1.2.2.</span> <span class="toc-text"> (2). VapourSynth-Preview</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#vscode"><span class="toc-number">1.2.2.1.</span> <span class="toc-text"> VSCode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vapoursynth"><span class="toc-number">1.2.2.2.</span> <span class="toc-text"> VapourSynth</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AF%B9%E6%AF%94%E8%84%9A%E6%9C%AC"><span class="toc-number">1.2.3.</span> <span class="toc-text"> (3). 对比脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-vs%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E5%92%8C%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="toc-number">1.3.</span> <span class="toc-text"> 3. VS 文档阅读和参数传递</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB"><span class="toc-number">1.3.1.</span> <span class="toc-text"> (1). 文档阅读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="toc-number">1.3.2.</span> <span class="toc-text"> (2). 参数传递</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%A7%86%E9%A2%91%E5%B1%9E%E6%80%A7%E5%92%8C%E5%B8%A7%E5%B1%9E%E6%80%A7"><span class="toc-number">1.4.</span> <span class="toc-text"> 4. 视频属性和帧属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%A7%86%E9%A2%91%E5%B1%9E%E6%80%A7-clip-property"><span class="toc-number">1.4.1.</span> <span class="toc-text"> (1). 视频属性 clip property</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B8%A7%E5%B1%9E%E6%80%A7-frame-property"><span class="toc-number">1.4.2.</span> <span class="toc-text"> (2). 帧属性 frame property</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-vspipe%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.5.</span> <span class="toc-text"> 5. VSPipe 的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E7%BB%83%E4%B9%A0"><span class="toc-number">1.6.</span> <span class="toc-text"> 6. 练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.6.1.</span> <span class="toc-text"> (1)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">1.6.2.</span> <span class="toc-text"> (2)</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li ><a href="/2023/05/17/vcbstudio/%E5%BC%80%E6%BA%90%E4%B8%80%E4%B8%8B%E5%BD%93%E5%88%9D%E5%8E%8B%E5%88%B6%E7%BB%84%E5%85%A5%E7%BB%84%E8%80%83%E8%AF%95%E7%9A%84%E7%AD%94%E5%8D%B7/" rel="bookmark" title="开源一下当初压制组入组考试的答卷">开源一下当初压制组入组考试的答卷</a></li><li ><a href="/2023/05/18/vcbstudio/%E5%BC%80%E6%BA%90%E4%B8%80%E4%B8%8B%E5%8E%8B%E5%88%B6%E7%BB%84%E8%80%83%E8%AF%95%E7%9A%84%E8%AF%95%E9%A2%98/" rel="bookmark" title="开源一下压制组考试的试题">开源一下压制组考试的试题</a></li><li ><a href="/2023/06/09/vcbstudio/%E7%86%9F%E6%82%89VapourSynth/" rel="bookmark" title="熟悉VapourSynth">熟悉VapourSynth</a></li><li ><a href="/2023/06/11/vcbstudio/%E7%A5%9E%E4%B8%80%E6%A0%B7%E7%9A%84%E5%B7%A5%E5%85%B7%E4%BB%AC/" rel="bookmark" title="神一样的工具们">神一样的工具们</a></li><li ><a href="/2023/06/11/vcbstudio/%E8%AE%A4%E8%AF%86%E7%91%95%E7%96%B5/" rel="bookmark" title="认识瑕疵">认识瑕疵</a></li><li ><a href="/2023/06/11/vcbstudio/VapourSynth%E5%9F%BA%E7%A1%80/" rel="bookmark" title="VapourSynth基础">VapourSynth基础</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E8%AE%A4%E8%AF%86%E8%A7%86%E9%A2%91/" rel="bookmark" title="第一章从零开始认识视频">第一章从零开始认识视频</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%B8%80%E5%88%87%E7%9A%84%E8%B5%B7%E7%82%B9%E2%80%94%E2%80%94%E8%AE%A4%E8%AF%86BD/" rel="bookmark" title="第二章一切的起点——认识BD">第二章一切的起点——认识BD</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E4%B8%89%E7%AB%A0%E7%A5%9E%E4%B8%80%E6%A0%B7%E7%9A%84%E5%B7%A5%E5%85%B7%E4%BB%AC/" rel="bookmark" title="第三章神一样的工具们">第三章神一样的工具们</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E8%AE%A4%E8%AF%86%E7%91%95%E7%96%B5/" rel="bookmark" title="第四章认识瑕疵">第四章认识瑕疵</a></li><li  class="active"><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E4%BA%94%E7%AB%A0VapourSynth%E5%9F%BA%E7%A1%80/" rel="bookmark" title="第五章VapourSynth基础">第五章VapourSynth基础</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%85%AD%E7%AB%A0VS%E5%9F%BA%E7%A1%80%E6%BB%A4%E9%95%9C/" rel="bookmark" title="第六章VS基础滤镜">第六章VS基础滤镜</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E4%B8%83%E7%AB%A0%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E5%99%A8%E5%9F%BA%E7%A1%80/" rel="bookmark" title="第七章视频编码器基础">第七章视频编码器基础</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%85%AB%E7%AB%A0VS%E8%A7%86%E9%A2%91%E5%A4%84%E7%90%86%E5%9F%BA%E7%A1%80/" rel="bookmark" title="第八章VS视频处理基础">第八章VS视频处理基础</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E4%B9%9D%E7%AB%A0%E5%88%9D%E7%BA%A7%E8%A7%86%E9%A2%91%E7%91%95%E7%96%B5%E4%BF%AE%E5%A4%8D/" rel="bookmark" title="第九章初级视频瑕疵修复">第九章初级视频瑕疵修复</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%8D%81%E7%AB%A0%E5%88%9D%E7%AD%8930fps%E5%A4%84%E7%90%86/" rel="bookmark" title="第十章初等30fps处理">第十章初等30fps处理</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0OKEGui%E7%9A%84%E4%BD%BF%E7%94%A8/" rel="bookmark" title="第十一章OKEGui的使用">第十一章OKEGui的使用</a></li><li ><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A08-bit%E4%BD%8E%E7%A0%81%E7%8E%87%E5%8E%8B%E5%88%B6/" rel="bookmark" title="第十二章8-bit低码率压制">第十二章8-bit低码率压制</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="Sakura" src="/assets/avatar.jpg"/><p class="name" itemprop="name">Sakura</p><div class="description" itemprop="description">一个专注于技术和思考分享的博客</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">76</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">6</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">25</span><span class="name">标签</span></a></div></nav><div class="social"><a href="mailto:mail@sakurame.eu.org" class="item email" title="mailto:mail@sakurame.eu.org"><i class="ic i-envelope"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于本站</a></li><li class="item"><a href="/admiration/" rel="section"><i class="ic i-coffee"></i>赞赏博主</a></li><li class="item"><a href="/privacy/" rel="section"><i class="ic i-user"></i>隐私政策</a></li></ul></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-sakura"></i>友链</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%85%AD%E7%AB%A0VS%E5%9F%BA%E7%A1%80%E6%BB%A4%E9%95%9C/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E8%AE%A4%E8%AF%86%E7%91%95%E7%96%B5/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/basic-theory/" title="分类于计算机基础理论">计算机基础理论</a></div><span><a href="/2023/07/11/basic-theory/A-Topologically-Informed-Hyperstreamline/">A_Topologically-Informed_Hyperstreamline</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/basic-theory/" title="分类于计算机基础理论">计算机基础理论</a></div><span><a href="/2024/03/29/computer-graphic/PBRT%E7%AC%AC%E5%9B%9B%E7%89%88%E4%B8%AA%E4%BA%BA%E7%B2%BE%E6%A0%A1%E7%89%88%E7%BF%BB%E8%AF%91%EF%BC%88%E9%95%BF%E6%9C%9F%E8%AE%A1%E5%88%92%E9%A1%B9%E7%9B%AE%EF%BC%89/">PBRT第四版个人精校版翻译（长期计划项目）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/game-engine/" title="分类于游戏引擎实践">游戏引擎实践</a></div><span><a href="/2023/06/28/game-engine/games104%E7%B3%BB%E5%88%97%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%BA%94%EF%BC%89/">games104系列笔记（十五）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/game-engine/" title="分类于游戏引擎实践">游戏引擎实践</a></div><span><a href="/2023/06/28/game-engine/games104%E7%B3%BB%E5%88%97%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89/">games104系列笔记（十二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/game-engine/" title="分类于游戏引擎实践">游戏引擎实践</a></div><span><a href="/2023/06/28/game-engine/games104%E7%B3%BB%E5%88%97%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%B8%83%EF%BC%89/">games104系列笔记（十七）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vcbstudio/" title="分类于视频压制技术">视频压制技术</a></div><span><a href="/2023/06/11/vcbstudio/VapourSynth%E5%9F%BA%E7%A1%80/">VapourSynth基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/game-engine/" title="分类于游戏引擎实践">游戏引擎实践</a></div><span><a href="/2023/06/25/game-engine/games104%E7%B3%BB%E5%88%97%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/">games104系列笔记（三）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/game-engine/" title="分类于游戏引擎实践">游戏引擎实践</a></div><span><a href="/2023/06/26/game-engine/games104%E7%B3%BB%E5%88%97%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%EF%BC%89/">games104系列笔记（十）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/game-engine/" title="分类于游戏引擎实践">游戏引擎实践</a></div><span><a href="/2023/06/25/game-engine/games104%E7%B3%BB%E5%88%97%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/">games104系列笔记（四）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vcbstudio/" title="分类于视频压制技术">视频压制技术</a></div><span><a href="/2024/03/16/vcbstudio/%E7%AC%AC%E5%85%AB%E7%AB%A0VS%E8%A7%86%E9%A2%91%E5%A4%84%E7%90%86%E5%9F%BA%E7%A1%80/">第八章VS视频处理基础</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; Sun Apr 23 2023 08:00:00 GMT+0800 (中国标准时间) -<span itemprop="copyrightYear">2024</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">Sakura @ Sakura's Blog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">1.6m 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">24:11</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div><br/><span style="display:inline;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:var(--grey-5);"><a target="_blank" href="https://icp.gov.moe/?keyword=20233555">萌ICP备20233555号 </a><br/><a target="_blank" href="https://beian.mps.gov.cn/#/query/webSearch?code=能躺在床上摸鱼摆烂是一天中最幸福的时刻"><img loading="lazy" decoding="async" data-src="/assets/search.png" style="max-width: 2em;display:inline;" width="20" height="20" alt="备案"/>能躺在床上摸鱼摆烂是一天中最幸福的时刻</a></span><div style="width: 100%;text-align:center;"><span id="time"></span></div><script>function createtime() {
    const n = new Date("2023/04/23 00:00:00");
    now.setTime(now.getTime() + 250), days = (now - n) / 1e3 / 60 / 60 / 24, dnum = Math.floor(days), hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum, hnum = Math.floor(hours), 1 == String(hnum).length && (hnum = "0" + hnum), minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum, mnum = Math.floor(minutes), 1 == String(mnum).length && (mnum = "0" + mnum), seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum, snum = Math.round(seconds), 1 == String(snum).length && (snum = "0" + snum), document.getElementById("time").innerHTML = "小破站已经在风雨飘摇中苟活" + dnum + " 天 " + hnum + " 小时 " + mnum + " 分 " + snum + " 秒"
}

const now = new Date;
setInterval("createtime()", 250)</script></div><div class="deng-box"><div class="deng"><div class="xian"></div><div class="deng-a"><div class="deng-b"><div class="deng-t">一</div></div></div><div class="shui shui-a"><div class="shui-c"></div><div class="shui-b"></div></div></div></div><div class="deng-box1"><div class="deng"><div class="xian"></div><div class="deng-a"><div class="deng-b"><div class="deng-t">十</div></div></div><div class="shui shui-a"><div class="shui-c"></div><div class="shui-b"></div></div></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `2024/03/16/vcbstudio/第五章VapourSynth基础/`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0&amp;features=default,fetch" defer></script><script src="/js/siteInit.js?v=0.4.11" type="module" fetchpriority="high" defer></script></body></html>